<html>
	<head>
		<meta charset="UTF-8" />
		<title>IPInformer Help</title>
	</head>
	
<b><center>Дополнительная информация</center></b><br>

Для чего можно использовать запуск внешней программы в "режиме паники".<br><br>

Например, для отключения всей сетевой активности, если случайно попали в стоп-страну. Как? Необходимо взять <code>devcon.exe</code> и готовые командные файлы из следующей инструкции, а потом воспользоваться последней инструкцией, если у вас Vista и выше, чтобы запускать файлы с админскими правами и без запроса UAC, и прописать нужную команду в настройках.<br><br>

<b><center>Включение и отключение сетевой активности с помощью DEVCON.EXE</center></b><br><br>

<p><b><center>Получение списка всех сетевых устройств</center></b>

<p><code>devcon.exe findall =net</code>

<p>Команда найдет и выведет на экран все сетевые устройства, включая виртуальные адаптеры, например, TUN/TAP от Openvpn или виртуальные адаптеры VMWare, а также те устройства, которые в данный момент не активны (отключены, или у них нет драйверов).

<p><code>devcon.exe find =net</code>

<p>Выводятся только активные устройства.

<p>Пример вывода <code>devcon.exe findall =net</code>:

<center><p><img src="IMAGES/devcon.png">

<b><p>Отключение всей сетевой активности</b></center>

<p><code>devcon.exe disable =net</code>

<p><b><center>Включение сетевой активности</center></b>

<p><code>devcon.exe enable =net</code>

<p><b>Внимание!</b> <code>devcon</code> необходимо запускать с админскими правами!

<p><b><center>Скачать набор devcon'ов</center></b>

<p>devcon'ы входят в разные пакеты SDK, отличающиеся гигантским размером. Я тут подобрал разные версии devcon'ов для разных ОС в одном архиве, ну и плюс батники для включения/отключения сети.

<p>Содержимое архива:<br>
batchfiles - пакетные файлы для включения и отключения сетевой активности
с помощью devcon, а также для получения списка сетевых устройств.<br><br>

x64 - devcon для Windows7-10 для 64-разрядных версий Windows.<br>
x86 - devcon для Windows7-10 для 32-разрядных версий Windows.<br>
XP\x64 - devcon для Windows XP 64-разрядной, работает только в WinXP x64.<br>
XP\x86 - devcon для Windows XP 32-разрядной, работает в WinXP x32 и, 
возможно, в Win Vista x32.

<p><b><a href="https://mega.nz/#!UcNj1aoR!FprZtl9Ps5OBGj_OSuugTtrN8uTTCiPvchcjf6qumx0" target="_blank" rel="noopener noreferrer">Скачать с Mega.nz (ZIP)</a></b><br>
<b><a href="https://mega.nz/#!JdUQnAzQ!n6vbXgr6prg_kuQuVn_m4fne2LYED74cGJ6xRhnD3ik" target="_blank" rel="noopener noreferrer">Автоматический установщик</a></b>

<p>
<p><center><b>Отключение запроса UAC для отдельных приложений</b></center>

<p><b><center>Преамбула</center></b>

<p>В Windows 7 и выше есть дополнительный механизм безопасности UAC (Контроль учетных записей пользователей). Обычно пользователь заходит в систему под учетной записью с ограниченными правами, а когда приложению для каких-то целей (установка драйверов, изменение файлов в системных папках и т.д.) требуются админские права, то соответствующий запрос появляется на экране у пользователя. 

<p><center><img src="IMAGES/u01.jpg"></center>

<p>В принципе, можно вообще отключить UAC, но это понизит безопасность системы, т.к. любое приложение (в т.ч. и зловредное) сможет без всякого запроса поднять себе права до уровня администратора, и сделать с системой все, что ему угодно.<br>
А вот для отдельных программ полезно было бы иметь возможность отключить уведомления. Например, у меня в автозагрузке есть несколько служебных программ, которым требуются права администратора, но неудобно <s>каждый раз копытом набирать номер</s> при каждой загрузке системы прихлопывать вылетающие окна с этим запросом :)

<p>На самом деле способов есть минимум 3:

- Скачать программку AdmiLink и ей воспользоваться (тогда приложение можно будет запускать и пользователю вообще не входящему в группу "Администраторы")<br>
- Скачать Microsoft Application Compatibility Toolkit, и воспользоваться им.<br>
- И третий, приглянувшийся мне, запускать программу с повышением прав с помощью "Планировщика заданий"

<p>Способ собственно тем и приглянулся, что не надо ничего качать, планировщик заданий есть на любой машине, а вот интернет не везде. Да, способ будет работать только для пользователей, входящих в группу "Администраторы" (для домашнего компьютера, при установке Windows по умолчанию, пользователь обычно в нее входит).

<p><b><center>Отключаем запрос UAC с помощью планировщика заданий

<p>Создаем задачу</center></b>

<p>Для примера создадим ярлык для запуска Редактора реестра (<code>regedit.exe</code>)

<p>1. Запускаем планировщик заданий <i>Пуск --> Все программы --> Стандартные --> Служебные --> Планировщик заданий</i> или в командной строке/через "Выполнить" (Win+R): 

<p><code>taskschd.msc /s</code>

<p>2. Справа в колонке <i>Действие</i> кликаем на <i>Создать задачу:</i>

<p><center><img src="IMAGES/u02.png"></center>

<p>3. В появившемся окне на вкладке <i>Общие</i> вводим в поле <i>Имя</i> какое-нибудь название, желательно латиницей и без пробелов, чтоб не морочиться потом с кавычками. Например, <code>regedit_adm</code>. Можно также оставить описание (в поле <i>Описание</i>), чтоб не запутаться если что, например, <code>Запуск Regedit с правами администратора</code>.

<p>4. <b>Обязательно ставим галочку</b> <i>Выполнить с наивысшими правами</i>.

<p><center><img src="IMAGES/u03.png"></center>

<p>5. Переходим на вкладку <i>Действия</i>. и жмем кнопку <i>Создать...</i><br>
6. В появившемся окне в поле <i>Действие</i> оставляем <i>Запуск программы</i>, а в поле <i>Программа или сценарий</i> прописываем путь к нужной программе или BAT/CMD файлу. При необходимости в соответствующих полях можно указать рабочую папку или необходимые аргументы командной строки.<br>

<p><center><img src="IMAGES/u04.png"></center>

<p>7. Нажимаем ОК, потом еще раз ОК, таким образом сохраняем задачу.<br>
Задача появится в Библиотеке планировщика заданий, где ее можно при необходимости посмотреть, изменить или удалить, когда станет не нужна.

<p><center><img src="IMAGES/u05.png"></center>

<p>Закрываем планировщик задач

<p><b><center>Создание ярлыка</center></b>

<p>1. Создаем ярлык на рабочем столе. Клик правой кнопкой и <i>Создать --> Ярлык</i><br>
2. В появившемся окне прописываем следующее:

<p><code>C:\Windows\System32\schtasks.exe /run /tn regedit_adm</code>

<p>где <code>regedit_adm</code> - имя созданной вами задачи.

<p>3. Нажимаем <i>Далее</i>, вводим имя ярлыка, например <code>Regedit с правами администратора</code><br>
4. Можно поменять в свойствах ярлыка значок для красоты. Кстати, внутри <code>Regedit32.exe</code> ВНЕЗАПНО обнаружился прикольный значок в винтажном стиле Windows 3.11

<p><center><img src="IMAGES/u06.png"></center>

<p>Запускаем ярлык. Окно UAC не появилось

<p>ФАНФАРЫ!

<p><p><b><a href="https://www.youtube.com/watch?v=r_oqyiG8wwM&feature=youtu.be">Видеоинструкция</a></b>
<p><p><b><a href="help.html">Назад</a></b>
</html>